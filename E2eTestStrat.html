<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive Testing Strategy Mind Map</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f0f4f8;
            color: #1e293b;
        }
        .mindmap-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 2rem;
        }
        .node {
            background-color: white;
            border-radius: 0.75rem;
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            margin: 0.5rem;
            padding: 1.25rem;
            border-left: 5px solid;
            transition: all 0.3s ease;
            width: 100%;
        }
        .node-title {
            font-weight: 600;
            font-size: 1.125rem;
            display: flex;
            align-items: center;
            cursor: pointer;
        }
        .node-title .icon {
            margin-right: 0.75rem;
            transition: transform 0.3s ease;
            width: 20px;
            height: 20px;
        }
        .node.open > .node-title .toggle-icon {
            transform: rotate(90deg);
        }
        .children {
            display: none;
            padding-top: 1rem;
            border-left: 2px solid #e2e8f0;
            margin-left: 1.25rem;
            padding-left: 1rem;
        }
        .node.open > .children {
            display: block;
        }
        .node-content {
            margin-top: 0.75rem;
            padding-left: 2.75rem;
            font-size: 0.95rem;
            color: #475569;
            line-height: 1.6;
        }
        .node-content ul {
            list-style-type: none;
            padding-left: 0;
        }
        .node-content li {
            position: relative;
            padding-left: 1.75rem;
            margin-bottom: 0.5rem;
        }
        .node-content li::before {
            content: '✓';
            position: absolute;
            left: 0;
            color: #10b981;
            font-weight: bold;
            font-size: 1.1rem;
        }
        .node-content strong {
            color: #0f172a;
        }
        .node.level-1 { border-color: #3b82f6; }
        .node.level-2 { border-color: #10b981; margin-left: 1.5rem; }
        .node.level-3 { border-color: #f97316; margin-left: 3rem; }
        .node.level-4 { border-color: #8b5cf6; margin-left: 4.5rem; }
        .node.level-5 { border-color: #ec4899; margin-left: 6rem; }

        .button-group {
            margin-bottom: 1.5rem;
        }
        .button-group button {
            background-color: #3b82f6;
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            border: none;
            cursor: pointer;
            margin: 0 0.5rem;
            font-weight: 500;
            transition: background-color 0.3s;
        }
        .button-group button:hover {
            background-color: #2563eb;
        }
        .button-group button.secondary {
            background-color: #64748b;
        }
        .button-group button.secondary:hover {
            background-color: #475569;
        }
        .list-decimal {
            list-style-position: inside;
        }
        .code-block {
            background-color: #1e293b;
            color: #e2e8f0;
            padding: 1rem;
            border-radius: 0.5rem;
            font-family: monospace;
            white-space: pre-wrap;
            margin-top: 0.5rem;
        }
    </style>
</head>
<body class="bg-gray-50">

    <div class="mindmap-container">
        <h1 class="text-4xl font-bold text-slate-800 mb-2 text-center">QA Strategy for a DDD & Event-Sourced Underwriting Platform</h1>
        <p class="text-slate-600 mb-6 text-center max-w-3xl">An advanced, interactive guide to testing a Health Underwriting application built on modern architectural patterns.</p>
        
        <div class="button-group">
            <button id="expand-all">Expand All</button>
            <button id="collapse-all" class="secondary">Collapse All</button>
        </div>

        <div id="mindmap-root" class="w-full max-w-7xl">
            <!-- Mind Map will be generated here -->
        </div>
    </div>

    <script>
        const mindmapData = {
            title: '1. Central Theme: Validating a Resilient, Domain-Driven Architecture',
            level: 1,
            icon: `<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>`,
            content: `<ul>
                <li><strong>Goal:</strong> To ensure the platform is robust, scalable, and correctly implements business logic by testing its domain model, command/query separation, and event-sourced nature directly.</li>
                <li><strong>Architectural Pillars:</strong> Domain-Driven Design (DDD), CQRS, Event Sourcing, Workflow Orchestration.</li>
            </ul>`,
            children: [
                {
                    title: '2. Domain-Driven Design (DDD) Testing Strategy',
                    level: 2,
                    icon: `<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M3.75 6A2.25 2.25 0 016 3.75h2.25A2.25 2.25 0 0110.5 6v2.25a2.25 2.25 0 01-2.25 2.25H6a2.25 2.25 0 01-2.25-2.25V6zM3.75 15.75A2.25 2.25 0 016 13.5h2.25a2.25 2.25 0 012.25 2.25V18a2.25 2.25 0 01-2.25 2.25H6A2.25 2.25 0 013.75 18v-2.25zM13.5 6a2.25 2.25 0 012.25-2.25H18A2.25 2.25 0 0120.25 6v2.25A2.25 2.25 0 0118 10.5h-2.25a2.25 2.25 0 01-2.25-2.25V6zM13.5 15.75a2.25 2.25 0 012.25-2.25H18a2.25 2.25 0 012.25 2.25V18A2.25 2.25 0 0118 20.25h-2.25A2.25 2.25 0 0113.5 18v-2.25z" /></svg>`,
                    content: '<strong>Principle:</strong> Testing is organized around business capabilities (Bounded Contexts), not technical layers.',
                    children: [
                        { title: 'Bounded Context: Proposal Ingestion & Validation', level: 3, content: `<ul>
                            <li><strong>Aggregate Testing:</strong> Validate the 'Proposal' aggregate invariants. E.g., a proposal cannot be submitted if the applicant's age is outside the serviceable range.</li>
                            <li><strong>Domain Event Testing:</strong> Ensure a successful submission publishes a 'ProposalSubmitted' event with the correct data schema.</li>
                        </ul>`},
                        { title: 'Bounded Context: Risk & Triage Assessment', level: 3, content: `<ul>
                            <li><strong>Aggregate Testing:</strong> Validate the 'Case' aggregate's risk calculation logic. Test that the 'CompositeRiskScore' is calculated correctly based on inputs.</li>
                            <li><strong>Domain Event Testing:</strong> Verify that after calculation, a 'RiskAssessmentCompleted' event is published.</li>
                        </ul>`},
                        { title: 'Bounded Context: Underwriting Adjudication', level: 3, content: `<ul>
                            <li><strong>Aggregate Testing:</strong> Test the 'UnderwritingCase' aggregate's state transitions. E.g., a case cannot move to 'Approved' state if the 'MERReport' is missing.</li>
                            <li><strong>Domain Event Testing:</strong> Verify that composing a counter-offer publishes a 'CounterOfferComposed' event.</li>
                        </ul>`},
                         { title: 'Bounded Context: Medical Assessment', level: 3, content: `<ul>
                            <li><strong>Aggregate Testing:</strong> Validate the 'MedicalCase' aggregate. Test that a lab can only be selected from the serviceable list.</li>
                             <li><strong>Domain Event Testing:</strong> Ensure scheduling a Tele-MER publishes a 'TeleMERScheduled' event.</li>
                        </ul>`},
                        { title: 'Bounded Context: Policy Issuance', level: 3, content: `<ul>
                            <li><strong>Aggregate Testing:</strong> Validate the 'Policy' aggregate's creation logic. A policy cannot be issued without final customer consent.</li>
                             <li><strong>Domain Event Testing:</strong> Verify a successful issuance publishes a 'PolicyIssued' event.</li>
                        </ul>`},
                        { title: 'Bounded Context: Configuration Management', level: 3, content: `<ul>
                            <li><strong>Aggregate Testing:</strong> Test the 'BusinessRuleSet' aggregate. Validate that a new rule version can be created but an old one cannot be deleted.</li>
                             <li><strong>Domain Event Testing:</strong> Verify that changing a rule publishes a 'BusinessRuleUpdated' event.</li>
                        </ul>`}
                    ]
                },
                {
                    title: '3. CQRS & Event Sourcing Testing Strategy',
                    level: 2,
                    icon: `<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M19.5 12c0-1.232-.046-2.453-.138-3.662a4.006 4.006 0 00-3.7-3.7 48.678 48.678 0 00-7.324 0 4.006 4.006 0 00-3.7 3.7c-.092 1.21-.138 2.43-.138 3.662v.114M19.5 12h-15m15 0v.114c0 1.232-.046-2.453-.138-3.662a4.006 4.006 0 01-3.7 3.7 48.678 48.678 0 01-7.324 0 4.006 4.006 0 01-3.7-3.7c-.092-1.21-.138-2.43-.138-3.662v-.114" /></svg>`,
                    content: '<strong>Principle:</strong> Test the write side (Commands) and read side (Queries) independently.',
                    children: [
                        { title: 'Command Side Testing', level: 3, content: `<ul>
                            <li><strong>Command Handler Validation:</strong> Test success and failure scenarios for each command. A failed command must NOT produce any events.</li>
                            <li><strong>Event Store Verification:</strong> On success, query the event store to verify the correct event(s) have been written.</li>
                            <li><strong>Immutability Testing:</strong> Write tests that attempt to alter a previously recorded event and assert that the operation fails.</li>
                        </ul>`},
                        { title: 'Query Side (Read Model) Testing', level: 3, content: `<ul>
                            <li><strong>Projection/Denormalizer Testing:</strong> Publish a domain event and assert that the relevant read model has been updated correctly.</li>
                            <li><strong>Event Replay Testing:</strong> Delete a read model, replay all events, and verify the read model is rebuilt to the exact same state.</li>
                        </ul>`}
                    ]
                },
                {
                    title: '4. Workflow Orchestration (Saga) Testing',
                    level: 2,
                    icon: `<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M3.75 12h16.5m-16.5 3.75h16.5M3.75 19.5h16.5M5.625 4.5h12.75a1.875 1.875 0 010 3.75H5.625a1.875 1.875 0 010-3.75z" /></svg>`,
                    content: '<strong>Principle:</strong> Test the end-to-end business process flow, including failures and compensating actions.',
                    children: [
                        { title: 'Happy Path E2E Testing', level: 3, content: `<ul>
                            <li>Initiate a process and verify the Saga orchestrator correctly moves through each step by reacting to expected domain events.</li>
                        </ul>`},
                        { title: 'Compensation Logic Testing', level: 3, content: `<ul>
                            <li>Simulate a failure at a critical step and verify the Saga executes the corresponding compensating action.</li>
                        </ul>`},
                        { title: 'Timeout and SLA Testing', level: 3, content: `<ul>
                            <li>Verify the orchestrator correctly handles timeouts if an expected event is not received within the configured SLA.</li>
                        </ul>`}
                    ]
                },
                {
                    title: '5. Data Engineering Stack Testing',
                    level: 2,
                    icon: `<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M20.25 6.375c0 2.278-3.694 4.125-8.25 4.125S3.75 8.653 3.75 6.375m16.5 0c0-2.278-3.694-4.125-8.25-4.125S3.75 4.097 3.75 6.375m16.5 0v11.25c0 2.278-3.694 4.125-8.25 4.125s-8.25-1.847-8.25-4.125V6.375" /></svg>`,
                    content: '<strong>Principle:</strong> Validate the integrity, accuracy, and performance of the analytics data pipeline.',
                     children: [
                        { title: 'Data Ingestion (ETL/ELT) Testing', level: 3, content: `<ul>
                            <li><strong>Source-to-Raw Validation:</strong> Generate domain events and verify the raw data lands in the data lake with 100% fidelity.</li>
                        </ul>`},
                        { title: 'Data Transformation & Quality Testing', level: 3, content: `<ul>
                            <li><strong>Transformation Logic:</strong> Test the jobs that create analytical tables.</li>
                             <li><strong>Data Quality Gates:</strong> Implement automated checks for nulls, anomalies, and data volume.</li>
                        </ul>`},
                        { title: 'Analytics & Dashboard Testing', level: 3, content: `<ul>
                             <li><strong>Metric Accuracy:</strong> Create controlled test cases and assert that aggregated metrics are correct.</li>
                             <li><strong>Dashboard UI Testing:</strong> Ensure all charts load correctly and filters function as expected.</li>
                        </ul>`}
                    ]
                },
                 {
                    title: '6. Core QA Strategy, Principles & Personas',
                    level: 1,
                    icon: `<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M3.75 21h16.5M4.5 3h15M5.25 3v18m13.5-18v18M9 6.75h6M9 11.25h6M9 15.75h6" /></svg>`,
                    content: 'The foundational elements that guide the entire QA process.',
                    children: [
                        {
                            title: 'Core Strategy: Dynamic & BRD-Driven Test Automation',
                            level: 2,
                            icon: `<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M9 6.75V15m0 0v-8.25m0 8.25h3.75m-3.75 0H5.25m11.25 0v-8.25m0 8.25h3.75m-3.75 0h-3.75m-3.75 0H1.5m16.5 0h3.75m-3.75 0h-3.75M9 15.75l3-3m0 0l3 3m-3-3v-6m-1.5 6l-3 3m3-3l3-3" /></svg>`,
                            children: [
                                {
                                    title: 'Dynamic Test Strategy & Coverage Analysis Tool (Python)',
                                    level: 3,
                                    children: [
                                        { title: 'Input Layer', level: 4, content: `<ul><li>Monitors BRD documents, OpenAPI specs, and environment configs.</li></ul>`},
                                        { title: 'Analysis Layer', level: 4, content: `<ul><li>Uses NLP to parse BRD requirements and generates a structured test plan.</li></ul>`},
                                        { title: 'Output Layer', level: 4, content: `<ul><li>Produces machine-readable test plans, a live traceability matrix, and change impact reports.</li></ul>`}
                                    ]
                                },
                                {
                                    title: 'Smart Test Implementation Generation (AI-Assisted)',
                                    level: 3,
                                    children: [
                                        { title: 'Strategy-to-Code Workflow', level: 4, content: `<ul><li>A script uses the structured test plan to send specific prompts to a local LLM, generating Robot Framework code.</li></ul>`},
                                        { title: 'Human-in-the-Loop Review', level: 4, content: `<ul><li>Generated code is submitted as a Pull Request for SDET review.</li></ul>`}
                                    ]
                                },
                                {
                                    title: 'Continuous Integration & Feedback Loop',
                                    level: 3,
                                    content: `<ol class="list-decimal list-inside space-y-2">
                                        <li>BRD changes trigger the analysis tool.</li>
                                        <li>Code changes trigger the full regression suite.</li>
                                        <li>Test results update the QA Dashboard.</li>
                                   </ol>`
                                }
                            ]
                        },
                        {
                            title: 'Test Principles, Metrics & Dashboard',
                            level: 2,
                            icon: `<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M10.5 6a7.5 7.5 0 100 15 7.5 7.5 0 000-15z" /><path stroke-linecap="round" stroke-linejoin="round" d="M12 10.5h.008v.008H12v-.008z" /><path stroke-linecap="round" stroke-linejoin="round" d="M10.5 12a1.5 1.5 0 113 0 1.5 1.5 0 01-3 0z" /></svg>`,
                            children: [
                                { title: 'Core Principles', level: 3, content: `<ul><li><strong>Shift-Left Testing, Test Pyramid, BDD, Continuous Testing.</strong></li></ul>`},
                                { title: 'Testing Types', level: 3, content: `<ul><li>Unit, Integration, E2E, Regression, Performance, Security (ABAC), Usability, Compatibility, AI/ML Model Testing.</li></ul>`},
                                { title: 'Live QA Dashboard', level: 3, content: `<ul><li>A single, real-time view of all QA metrics. Widgets include: BRD Coverage, Pass/Fail Trends, Defect Density, Performance SLAs, CI/CD Health.</li></ul>`}
                            ]
                        },
                        {
                            title: 'Test Techniques & Knowledge Management',
                            level: 2,
                            icon: `<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M12 6.042A8.967 8.967 0 006 3.75c-1.052 0-2.062.18-3 .512v14.25A8.987 8.987 0 016 18c2.305 0 4.408.867 6 2.292m0-14.25a8.966 8.966 0 016-2.292c1.052 0 2.062.18 3 .512v14.25A8.987 8.987 0 0018 18a8.967 8.967 0 00-6 2.292m0-14.25v14.25" /></svg>`,
                             children: [
                                { title: 'Manual & Exploratory', level: 3, content: `<ul><li><strong>Exploratory Testing, Usability Testing.</strong></li></ul>`},
                                { title: 'AI-Generative & Smart', level: 3, content: `<ul><li><strong>AI-Driven Test Data Generation, Intelligent Log Analysis.</strong></li></ul>`},
                                { title: 'Living Documentation & Knowledge Bank', level: 3, content: `<ul><li>A centralized wiki where documentation is automatically generated and updated by the CI/CD pipeline.</li></ul>`}
                            ]
                        },
                        {
                            title: 'Personas & Roles (Actors in the System)',
                            level: 2,
                            icon: `<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M15 19.128a9.38 9.38 0 002.625.372 9.337 9.337 0 004.121-.952 4.125 4.125 0 00-7.533-2.493M15 19.128v-.003c0-1.113-.285-2.16-.786-3.07M15 19.128v.106A12.318 12.318 0 018.624 21c-2.331 0-4.512-.645-6.374-1.766l-.001-.109a6.375 6.375 0 0111.964-4.67c.12-.24.232-.487.335-.737M12 12c-1.882 0-3.418-.99-4.237-2.433A6.375 6.375 0 0112 4.875c1.882 0 3.418.99 4.237 2.433A6.375 6.375 0 0112 12z" /></svg>`,
                            children: [
                                { title: 'Customer', level: 3, content: `<ul><li><strong>Role:</strong> Applicant seeking insurance.</li><li><strong>Actions:</strong> Fills proposal, schedules medicals, provides consent.</li></ul>`},
                                { title: 'Broker / Agent', level: 3, content: `<ul><li><strong>Role:</strong> Intermediary.</li><li><strong>Actions:</strong> Initiates proposals, monitors status.</li></ul>`},
                                { title: 'MER Doctor', level: 3, content: `<ul><li><strong>Role:</strong> Medical professional.</li><li><strong>Actions:</strong> Conducts MER, submits report.</li></ul>`},
                                { title: 'Underwriter', level: 3, content: `<ul><li><strong>Role:</strong> Core decision-maker.</li><li><strong>Actions:</strong> Reviews case, makes decision, escalates.</li></ul>`},
                                { title: 'UW Head / Manager', level: 3, content: `<ul><li><strong>Role:</strong> Senior manager.</li><li><strong>Actions:</strong> Configures rules, manages templates, acts as "Checker".</li></ul>`},
                                { title: 'Operations Coordinator', level: 3, content: `<ul><li><strong>Role:</strong> Manages process health.</li><li><strong>Actions:</strong> Monitors for failures and intervenes.</li></ul>`},
                                { title: 'System (Automated Actor)', level: 3, content: `<ul><li><strong>Role:</strong> Automated agent.</li><li><strong>Actions:</strong> Generates IDs, runs checks, sends communications, logs audit trail.</li></ul>`}
                            ]
                        }
                    ]
                },
                 {
                    title: '7. Detailed Test Type Scenarios & Implementation',
                    level: 1,
                    icon: `<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M9.75 3.104v5.714a2.25 2.25 0 01-.659 1.591L5 14.5M9.75 3.104c-.251.023-.501.05-.75.082m.75-.082a24.301 24.301 0 014.5 0m0 0v5.714c0 .597.237 1.17.659 1.591L19.8 14.5M14.25 3.104c.251.023.501.05.75.082M19.8 14.5L14.25 10m-8.25 4.5l7.5 7.5 7.5-7.5M3 10h18M7.5 3h9" /></svg>`,
                    content: 'A detailed breakdown of how API, UI, and Contract testing are applied across the architecture, with scenarios tied to the BRD.',
                    children: [
                        {
                            title: 'API Testing (CQRS & Integration)',
                            level: 2,
                            icon: `<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M13.19 8.688a4.5 4.5 0 011.242 7.244l-4.5 4.5a4.5 4.5 0 01-6.364-6.364l1.757-1.757m13.35-.622l1.757-1.757a4.5 4.5 0 00-6.364-6.364l-4.5 4.5a4.5 4.5 0 001.242 7.244" /></svg>`,
                            children: [
                                { title: 'Command API Scenarios', level: 3, content: `<ul>
                                    <li><strong>POST /proposals:</strong> Verify success (201), validation failures (400) for invalid age/pincode, and auth for Broker role.</li>
                                    <li><strong>POST /cases/{id}/decisions:</strong> Test 'Approve', 'Decline', 'Counter-Offer' commands. Verify ABAC ensures only assigned Underwriter can post.</li>
                                    <li><strong>POST /rulesets/{id}/rules:</strong> As UW Head, test adding a new fraud detection rule.</li>
                                </ul>`},
                                { title: 'Query API Scenarios', level: 3, content: `<ul>
                                    <li><strong>GET /workbench/cases?assignee=...:</strong> As Underwriter, verify only assigned cases are returned.</li>
                                    <li><strong>GET /proposals/{id}/status:</strong> As Broker, verify status is returned but medical details are excluded.</li>
                                    <li><strong>GET /analytics/team-performance:</strong> As UW Head, verify the API returns aggregated TAT and productivity metrics.</li>
                                </ul>`},
                                { title: 'Integration & External API Testing', level: 3, content: `<ul>
                                    <li><strong>CIBIL/KYC:</strong> Use mock servers to simulate success, failure, and timeout responses.</li>
                                    <li><strong>Policy Administration System (PAS):</strong> Test the final API call to issue a policy and handle connection errors.</li>
                                </ul>`}
                            ]
                        },
                        {
                            title: 'UI Testing (Persona & Component)',
                            level: 2,
                            icon: `<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M9 17.25v1.007a3 3 0 01-.879 2.122L7.5 21h9l-1.621-1.621A3 3 0 0115 18.257V17.25m6-12V15a2.25 2.25 0 01-2.25 2.25H5.25A2.25 2.25 0 013 15V5.25m18 0A2.25 2.25 0 0018.75 3H5.25A2.25 2.25 0 003 5.25m18 0V12a2.25 2.25 0 01-2.25 2.25H5.25A2.25 2.25 0 013 12V5.25" /></svg>`,
                             children: [
                                { title: 'End-to-End Persona Journeys', level: 3, content: `<ul>
                                    <li><strong>Customer E2E:</strong> Automate the full flow from proposal form -> scheduling MER -> providing OTP consent.</li>
                                    <li><strong>Underwriter E2E:</strong> Login -> open Workbench -> select case -> compose counter-offer -> submit for approval.</li>
                                    <li><strong>UW Head E2E:</strong> Login -> navigate to Rules Admin UI -> modify a risk score threshold -> save and publish.</li>
                                </ul>`},
                                { title: 'Component & Visual Regression Testing', level: 3, content: `<ul>
                                    <li><strong>Component Library:</strong> Test UI components in isolation across different states.</li>
                                    <li><strong>Visual Regression:</strong> Take automated screenshots of key pages and compare against a baseline to catch unintended visual changes.</li>
                                </ul>`}
                            ]
                        },
                        {
                            title: 'Contract Testing (Pact)',
                            level: 2,
                            icon: `<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 00-3.375-3.375h-1.5A1.125 1.125 0 0113.5 7.125v-1.5a3.375 3.375 0 00-3.375-3.375H8.25m0 12.5h9" /></svg>`,
                            content: '<strong>Impact:</strong> Prevents integration failures between independently deployed services. Failures are caught during the CI pipeline, not in production.',
                             children: [
                                { title: 'Internal Service Contracts (Event-Driven)', level: 3, content: `<ul>
                                    <li><strong>Consumer (Risk Assessment Service):</strong> Defines a contract expecting a 'ProposalSubmitted' event with specific fields.</li>
                                    <li><strong>Provider (Proposal Ingestion Service):</strong> A test verifies it generates an event that satisfies the contract.</li>
                                </ul>`},
                                { title: 'Internal API Contracts', level: 3, content: `<ul>
                                    <li><strong>Consumer (Adjudication Service):</strong> Defines a contract for how it will call the PAS to issue a policy.</li>
                                    <li><strong>Provider (Policy Administration System):</strong> The PAS team runs tests to verify their API endpoint satisfies the contract.</li>
                                </ul>`}
                            ]
                        }
                    ]
                },
                {
                    title: '8. Architectural Requirements Testing (BRD Section 1)',
                    level: 1,
                    icon: `<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M10.25 2.25h-4.5a2.25 2.25 0 00-2.25 2.25v15A2.25 2.25 0 005.75 22.5h12.5a2.25 2.25 0 002.25-2.25v-15a2.25 2.25 0 00-2.25-2.25H13.75m-3.5 0v1.5m0-1.5h3.5m-3.5 0p-3.5 0M10.25 6.75h3.5m-3.5 3h3.5m-3.5 3h3.5m-3.5 3h3.5M10.25 2.25c-1.12 0-2.05.5-2.625 1.25M13.75 2.25c1.12 0 2.05.5 2.625 1.25" /></svg>`,
                    content: 'Validating the core, cross-cutting architectural principles defined as high-level project requirements.',
                     children: [
                        {
                            title: 'Attribute-Based Access Control (ABAC) Testing',
                            level: 2,
                            icon: `<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M16.5 10.5V6.75a4.5 4.5 0 10-9 0v3.75m-.75 11.25h10.5a2.25 2.25 0 002.25-2.25v-6.75a2.25 2.25 0 00-2.25-2.25H6.75a2.25 2.25 0 00-2.25 2.25v6.75a2.25 2.25 0 002.25 2.25z" /></svg>`,
                            children: [
                                { title: 'Underwriter Role Scenarios', level: 3, content: `<ul>
                                    <li><strong>API Test:</strong> Authenticate as an Underwriter and call 'GET /workbench/cases'. Assert that only cases with 'assigneeId' matching the Underwriter's ID are returned.</li>
                                    <li><strong>UI Test:</strong> Login as an Underwriter. Navigate to the workbench. Verify that the UI only displays cases assigned to this user. Attempt to access a case assigned to another underwriter via a direct URL and assert access is denied.</li>
                                </ul>`},
                                { title: 'Broker/Agent Role Scenarios', level: 3, content: `<ul>
                                    <li><strong>API Test:</strong> Authenticate as a Broker. Call 'GET /proposals/{id}/status' for a proposal they sourced. Assert a 200 OK with status data. Call the same endpoint for a proposal they did NOT source and assert a 403 Forbidden or 404 Not Found.</li>
                                    <li><strong>API Test:</strong> Verify that the response for the proposal status does NOT contain any medical details fields.</li>
                                </ul>`},
                                 { title: 'UW Head Role Scenarios', level: 3, content: `<ul>
                                    <li><strong>API Test:</strong> Authenticate as a UW Head. Call 'GET /workbench/cases?team=MyTeam'. Assert that all cases for their team are returned, regardless of assignee.</li>
                                    <li><strong>UI Test:</strong> Login as UW Head. Verify they can see an overview of all cases for their team and have a UI option to manually re-assign a case.</li>
                                </ul>`},
                                { title: 'Doctor Role Scenarios', level: 3, content: `<ul>
                                    <li><strong>API Test:</strong> Authenticate as a Doctor. Call 'GET /mer-cases/{id}/medical-details'. Assert a 200 OK for an assigned case. Call the same endpoint for a non-assigned case and assert a 403 Forbidden.</li>
                                </ul>`}
                            ]
                        },
                         {
                            title: 'Integration Point Validation',
                            level: 2,
                            icon: `<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M12 21a9.004 9.004 0 008.716-6.747M12 21a9.004 9.004 0 01-8.716-6.747M12 21c2.485 0 4.5-4.03 4.5-9S14.485 3 12 3m0 18c-2.485 0-4.5-4.03-4.5-9S9.515 3 12 3m0 0a8.997 8.997 0 017.843 4.582M12 3a8.997 8.997 0 00-7.843 4.582m15.686 0A11.953 11.953 0 0112 10.5c-2.998 0-5.74-1.1-7.843-2.918m15.686 0A8.959 8.959 0 0121 12c0 .778-.099 1.533-.284 2.253m0 0A17.919 17.919 0 0112 16.5c-3.162 0-6.133-.815-8.716-2.247m17.432 0A17.919 17.919 0 0012 16.5c3.162 0 6.133-.815 8.716-2.247" /></svg>`,
                             children: [
                                { title: 'Internal Core Systems', level: 3, content: `<ul>
                                    <li><strong>PAS:</strong> Contract tests and E2E tests for eligibility checks and final policy issuance.</li>
                                    <li><strong>Pricing Engine:</strong> Performance and integration tests to ensure real-time premium calculation is fast and accurate under load.</li>
                                     <li><strong>Communications Gateway:</strong> E2E tests that trigger an SMS/Email and use a mock service (like MailHog) to verify the communication was sent with the correct template and data.</li>
                                </ul>`},
                                { title: 'External Third-Party Systems', level: 3, content: `<ul>
                                    <li><strong>CIBIL/KYC:</strong> Integration tests using mock servers to simulate various responses (success, failure, user not found, timeout) and ensure the system handles each case correctly.</li>
                                    <li><strong>Lab/TPA Portals:</strong> Test both the primary API integration and the fallback RPA process. Create scenarios where the API fails to ensure the RPA bot is correctly triggered as a compensating action.</li>
                                </ul>`}
                            ]
                        },
                        {
                            title: 'Declarative Configuration Testing',
                            level: 2,
                            icon: `<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M10.343 3.94c.09-.542.56-1.007 1.11-1.227a48.13 48.13 0 011.66 0c.55.22 1.02.685 1.11 1.227l.128.765a48.273 48.273 0 012.358 1.256l.764-.128c.542-.09 1.007.56 1.227 1.11a48.13 48.13 0 010 1.66c-.22.55-.685 1.02-1.227 1.11l-.765.128a48.273 48.273 0 01-1.256 2.358l.128.764c.09.542-.56 1.007-1.11 1.227a48.13 48.13 0 01-1.66 0c-.55-.22-1.02-.685-1.11-1.227l-.128-.765a48.273 48.273 0 01-2.358-1.256l-.764.128c-.542.09-1.007-.56-1.227-1.11a48.13 48.13 0 010-1.66c.22-.55.685-1.02 1.227-1.11l.765-.128a48.273 48.273 0 011.256-2.358l-.128-.764zM12 9a3 3 0 100 6 3 3 0 000-6z" /></svg>`,
                             children: [
                                { title: 'Business Rules', level: 3, content: `<ul><li><strong>Test Flow:</strong> 1. Run a test case for a low-risk applicant and assert they go to the Green Channel. 2. As UW Head, use the Admin UI to lower the Green Channel threshold. 3. Rerun the exact same test case. 4. Assert the applicant now goes to the Amber Channel. This proves the configuration change worked without a deployment.</li></ul>`},
                                { title: 'Workflow Paths', level: 3, content: `<ul><li>Similar to above, configure a workflow step to be skipped for a certain plan type, then run tests to verify the workflow orchestrator correctly bypasses that step.</li></ul>`},
                                { title: 'SLA Timers', level: 3, content: `<ul><li>Adjust an SLA timer for MER scheduling, then run a test where the customer does not schedule within the new, shorter time. Verify an escalation event is triggered correctly.</li></ul>`},
                                { title: 'Content Templates', level: 3, content: `<ul><li>As a business user, update the text of the counter-offer email template. Trigger a counter-offer scenario and verify the customer receives the updated communication.</li></ul>`}
                            ]
                        },
                        {
                            title: 'Event-Driven Architecture Validation',
                            level: 2,
                            icon: `<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M3.75 13.5l10.5-11.25L12 10.5h8.25L9.75 21.75 12 13.5H3.75z" /></svg>`,
                             children: [
                                { title: 'Key Business Event Verification', level: 3, content: `<ul>
                                    <li>For each key event listed in the BRD (e.g., 'proposal.submitted', 'risk_assessment.completed', 'mer.completed', 'lab_report.received', 'uw.decision.made'), create a dedicated test.</li>
                                    <li>The test should trigger the upstream action, then consume from the message bus (e.g., Kafka topic) to verify: 1. The event was published. 2. The event schema matches the defined contract. 3. The event payload contains the correct data for the specific test case.</li>
                                </ul>`}
                            ]
                        }
                    ]
                }
            ]
        };

        function createNode(nodeData) {
            const nodeEl = document.createElement('div');
            nodeEl.className = `node level-${nodeData.level}`;

            let childrenHtml = '';
            if (nodeData.children && nodeData.children.length > 0) {
                childrenHtml = `<div class="children">${nodeData.children.map(createNode).join('')}</div>`;
            }

            const toggleIcon = nodeData.children ? `<span class="icon toggle-icon">▶</span>` : `<span class="icon"></span>`;
            const nodeIcon = nodeData.icon || '';
            
            nodeEl.innerHTML = `
                <div class="node-title">
                    ${toggleIcon}
                    <span class="icon">${nodeIcon}</span>
                    <span>${nodeData.title}</span>
                </div>
                ${nodeData.content ? `<div class="node-content">${nodeData.content}</div>` : ''}
                ${childrenHtml}
            `;
            return nodeEl.outerHTML;
        }

        document.addEventListener('DOMContentLoaded', function () {
            const mindmapRoot = document.getElementById('mindmap-root');
            mindmapRoot.innerHTML = createNode(mindmapData);

            mindmapRoot.addEventListener('click', function(event) {
                const title = event.target.closest('.node-title');
                if (title) {
                    const node = title.parentElement;
                    if (node.querySelector('.children')) {
                       node.classList.toggle('open');
                    }
                }
            });

            document.getElementById('expand-all').addEventListener('click', () => {
                document.querySelectorAll('#mindmap-root .node').forEach(node => {
                    if (node.querySelector('.children')) {
                        node.classList.add('open');
                    }
                });
            });

            document.getElementById('collapse-all').addEventListener('click', () => {
                 document.querySelectorAll('#mindmap-root .node.open').forEach(node => {
                    node.classList.remove('open');
                });
                // Keep the root open
                document.querySelector('#mindmap-root .node.level-1').classList.add('open');
            });
            
            // Initially open all nodes for full visibility
            document.querySelectorAll('#mindmap-root .node').forEach(node => {
                if (node.querySelector('.children')) {
                    node.classList.add('open');
                }
            });
        });

    </script>

</body>
</html>

